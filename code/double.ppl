-- Requires tag polymorphism.

data Nat = Zero | Succ Nat;

define double : Nat -> Nat = \n : Nat.
  case n of
  | Zero -> Zero
  | Succ m -> Succ (Succ (double m));

data Unit = unit;

define weigh : Nat -> Unit = \n : Nat.
  case n of
  | Zero -> sample fail
  | Succ m -> amb unit (weigh m);

weigh (double (double (Succ Zero)))