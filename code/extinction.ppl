{- Probability of extinction of a (patronymic) surname if each man has zero or two sons. -}

data Unit = unit;
data Bool = false | true;

extern p: Bool; -- false = 0 sons, true = 2 sons

define extinct: Unit =
  case p of
    | false -> unit
    | true -> (\ u1 : Unit. \ u2 : Unit. unit) extinct extinct;

extinct -- Should be {unit: min(0, (1-p)/p)}
